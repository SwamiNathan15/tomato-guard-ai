<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>TOMATO GUARD AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:radial-gradient(circle at top,#e8f5e9,#f1f8e9);
  padding:40px;
}

/* ===== LAYOUT ===== */
.layout{
  display:flex;
  gap:40px;
  max-width:1200px;
  margin:auto;
  align-items:flex-start;
}

/* ===== APP ===== */
.app{
  width:420px;
  background:#fff;
  border-radius:20px;
  box-shadow:0 25px 60px rgba(0,0,0,.18);
  overflow:hidden;
}

.header{
  background:linear-gradient(135deg,#2e7d32,#43a047);
  color:#fff;
  text-align:center;
  padding:18px;
  font-weight:700;
}

.section{padding:20px;}

.upload-box{
  border:2px dashed #c8e6c9;
  border-radius:16px;
  padding:20px;
  text-align:center;
}

.file-btn{
  background:#fff;
  border:1px solid #ccc;
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
}

.analyze-btn{
  margin-top:14px;
  background:linear-gradient(135deg,#2e7d32,#43a047);
  color:#fff;
  border:none;
  padding:14px;
  width:100%;
  border-radius:30px;
  cursor:pointer;
}

.preview{
  width:100%;
  border-radius:16px;
  margin:16px 0;
}

/* ===== RESULT ===== */
.result-card{
  background:#ffebee;
  border-left:6px solid #c62828;
  border-radius:16px;
  padding:16px;
  margin-top:14px;
}

.progress{
  height:10px;
  background:#eee;
  border-radius:8px;
  overflow:hidden;
  margin:8px 0;
}

.progress-bar{
  height:100%;
  background:linear-gradient(90deg,#c62828,#ff5252);
}

/* ===== REMEDIES ===== */
.remedy-scroll{
  display:flex;
  gap:12px;
  overflow-x:auto;
  margin-top:10px;
}

.remedy-card{
  min-width:180px;
  background:#f1f8e9;
  border-radius:14px;
  padding:12px;
  font-size:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.1);
  cursor:pointer;
  transition:.3s;
}

.remedy-card:hover{transform:translateY(-4px);}

/* ===== SIDE PANEL ===== */
.side-panel{
  flex:1;
  background:#fff;
  border-radius:20px;
  padding:24px;
  box-shadow:0 20px 50px rgba(0,0,0,.1);
  animation:fadeIn .6s ease;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(20px);}
  to{opacity:1;}
}

/* ===== MODAL ===== */
.remedy-modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  z-index:9999;
  align-items:center;
  justify-content:center;
}

.modal-content{
  background:#fff;
  width:90%;
  max-width:420px;
  border-radius:16px;
  padding:20px;
}

.close-btn{
  float:right;
  font-size:22px;
  cursor:pointer;
}

@media(max-width:900px){
  .layout{flex-direction:column;align-items:center;}
}
</style>
</head>

<body>

<div class="layout">

<!-- LEFT APP -->
<div class="app">
  <div class="header">TOMATO GUARD AI</div>
  <div class="section">

    <div class="upload-box">
      <form action="/upload" method="post" enctype="multipart/form-data">
        <input type="file" id="fileInput" name="image" hidden required>
        <button type="button" class="file-btn" onclick="fileInput.click()">Choose File</button>
        <p id="fileName">No file chosen</p>
        <button class="analyze-btn">Analyze Plant Health</button>
      </form>
    </div>

    {% if result %}
    <img src="{{ image_url }}" class="preview">

    <div class="result-card">
      <b>{{ result }}</b><br>
      Confidence: {{ confidence }}

      <div class="progress">
        <div class="progress-bar" style="width:{{ confidence|replace('%','') }}%"></div>
      </div>

      <b>ðŸŒ¿ Organic Remedies</b>
      <div class="remedy-scroll">
        <div class="remedy-card" onclick="openRemedy('remove_leaves')">Remove infected leaves</div>
        <div class="remedy-card" onclick="openRemedy('copper_fungicide')">Copper fungicide</div>
        <div class="remedy-card" onclick="openRemedy('neem_oil')">Neem oil spray</div>
        <div class="remedy-card" onclick="openRemedy('airflow')">Improve airflow</div>
      </div>
    </div>
    {% endif %}

  </div>
</div>

<!-- RIGHT PANEL (ONLY AFTER RESULT) -->
{% if result %}
<div class="side-panel">

  <h3>ðŸ¦  Disease Overview</h3>
  <p>
    {{ result }} spreads rapidly in warm and humid conditions.
    Early diagnosis prevents severe yield loss.
  </p>

  <h3>âš  Severity Level</h3>
  <div class="progress">
    <div class="progress-bar" style="width:75%"></div>
  </div>
  <small>High risk if untreated</small>

  <h3>ðŸŒ¿ How Organic Remedies Help</h3>
  <ul>
    <li>Ecoâ€‘friendly disease control</li>
    <li>Safe for soil and crops</li>
    <li>Sustainable farming practice</li>
  </ul>

  <h3>ðŸ›¡ Prevention Tips</h3>
  <ul>
    <li>Avoid overhead watering</li>
    <li>Ensure airflow</li>
    <li>Remove infected leaves early</li>
  </ul>

</div>
{% endif %}

</div>

<!-- REMEDY MODAL -->
<div class="remedy-modal" id="remedyModal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeRemedy()">&times;</span>
    <h3 id="remedyTitle"></h3>
    <p id="remedyDesc"></p>
    <h4>ðŸ§ª How to Use</h4>
    <ul id="remedySteps"></ul>
    <h4>ðŸ›’ Buying Guide</h4>
    <p id="remedyBuy"></p>
  </div>
</div>

<script>
fileInput.onchange=()=>fileName.innerText=fileInput.files[0]?.name||"No file chosen";

const remedyDetails={
  remove_leaves:{title:"Remove Infected Leaves",description:"Stops disease spread.",steps:["Wear gloves","Cut infected leaves","Dispose safely"],buy:"No purchase needed"},
  copper_fungicide:{title:"Copper Fungicide",description:"Controls fungal disease.",steps:["Mix correctly","Spray morning","Repeat weekly"],buy:"Agri stores"},
  neem_oil:{title:"Neem Oil",description:"Organic pest control.",steps:["Dilute","Spray weekly"],buy:"Organic stores"},
  airflow:{title:"Improve Airflow",description:"Reduces moisture.",steps:["Prune plants","Avoid overcrowding"],buy:"No purchase"}
};

function openRemedy(key){
  const d=remedyDetails[key];
  remedyTitle.innerText=d.title;
  remedyDesc.innerText=d.description;
  remedySteps.innerHTML=d.steps.map(s=>`<li>${s}</li>`).join("");
  remedyBuy.innerText=d.buy;
  remedyModal.style.display="flex";
}
function closeRemedy(){remedyModal.style.display="none";}
</script>

</body>
</html>
